---
export interface Props {
  title: string;
  slug: string;
  character: string;
  portrait: string;
  compact?: boolean;
}

const { title, slug, character, portrait, compact = false } = Astro.props;

const cardClass = compact
  ? 'border-b border-white/10 py-4 hover:bg-black/60 transition-colors'
  : 'group/card relative overflow-hidden rounded border border-white/10 bg-black/60 shadow-[0_0_25px_rgba(0,0,0,0.45)] transition-all duration-300 hover:-translate-y-1 hover:border-ic-alert/70 hover:shadow-[0_0_35px_rgba(217,58,58,0.3)]';

const base = import.meta.env.BASE_URL;
---

<article class={cardClass}>
  <a href={`${base}/stories/${slug}`} class="block group">
    {!compact && (
      <div class="relative aspect-[3/4] overflow-hidden bg-black/60">
        <div class="absolute inset-0 opacity-20 bg-[radial-gradient(circle_at_top,rgba(217,58,58,0.6),transparent_60%)]"></div>
        <img
          src={`${base}${portrait}`}
          alt={`Portrait of ${character}`}
          class="relative z-[1] h-full w-full object-cover transition-transform duration-500 group-hover/card:scale-110"
          loading="lazy"
        />
        <span class="absolute inset-x-0 bottom-0 h-16 bg-gradient-to-t from-black via-black/40 to-transparent"></span>
      </div>
    )}

    <div class={`p-5 ${!compact && 'bg-black/70'}`}>
      <h3 class="text-lg font-label uppercase tracking-[0.45em] text-white group-hover/card:text-ic-alert transition-colors">
        {title}
      </h3>
    </div>
  </a>
</article>

<style>
  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
